<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè¶ Loan Prediction Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #4CAF50, #45a049); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .form-container { padding: 40px; }
        .form-group { margin-bottom: 25px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 1.1em; }
        .form-group input, .form-group select { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #4CAF50; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .submit-btn { width: 100%; background: linear-gradient(135deg, #4CAF50, #45a049); color: white; padding: 18px; border: none; border-radius: 8px; font-size: 1.2em; font-weight: 600; cursor: pointer; transition: transform 0.2s; }
        .submit-btn:hover { transform: translateY(-2px); }
        .result { margin-top: 30px; padding: 25px; border-radius: 8px; text-align: center; font-size: 1.3em; font-weight: 600; display: none; }
        .result.approved { background: #d4edda; color: #155724; border: 2px solid #c3e6cb; }
        .result.rejected { background: #f8d7da; color: #721c24; border: 2px solid #f5c6cb; }
        .note { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè¶ Loan Prediction Dashboard</h1>
            <p>AI-Powered Loan Approval System</p>
        </div>
        
        <div class="form-container">
            <form id="loanForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="dependents">Number of Dependents</label>
                        <input type="number" id="dependents" name="dependents" min="0" max="10" value="2" required>
                    </div>
                    <div class="form-group">
                        <label for="education">Education Level</label>
                        <select id="education" name="education" required>
                            <option value="Graduate">Graduate</option>
                            <option value="Not Graduate">Not Graduate</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="self_employed">Self Employed</label>
                        <select id="self_employed" name="self_employed" required>
                            <option value="No">No</option>
                            <option value="Yes">Yes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="income">Annual Income (‚Çπ)</label>
                        <input type="number" id="income" name="income" min="100000" value="5000000" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="loan_amount">Loan Amount (‚Çπ)</label>
                        <input type="number" id="loan_amount" name="loan_amount" min="100000" value="10000000" required>
                    </div>
                    <div class="form-group">
                        <label for="loan_term">Loan Term (Years)</label>
                        <input type="number" id="loan_term" name="loan_term" min="1" max="30" value="15" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="credit_score">Credit Score</label>
                        <input type="number" id="credit_score" name="credit_score" min="300" max="850" value="750" required>
                    </div>
                    <div class="form-group">
                        <label for="total_asset">Total Assets (‚Çπ)</label>
                        <input type="number" id="total_asset" name="total_asset" min="100000" value="15000000" required>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn">
                    üîÆ Predict Loan Status
                </button>
            </form>
            
            <div class="result" id="result"></div>
            
            <div class="note">
                <strong>Note:</strong> Connected to our trained AI model via SageMaker endpoint. 
                Real predictions from our model.pkl file.
            </div>
        </div>
    </div>

    <script>
        document.getElementById('loanForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = new FormData(this);
            const data = Object.fromEntries(formData);
            
            // Prepare data for your trained model
            const modelInput = {
                no_of_dependents: parseInt(data.dependents),
                education: data.education === 'Graduate' ? 0 : 1,
                self_employed: data.self_employed === 'Yes' ? 1 : 0,
                income_annum: Math.log(parseFloat(data.income) + 1),
                loan_amount: Math.log(parseFloat(data.loan_amount) + 1),
                loan_term: parseInt(data.loan_term),
                credit_score: parseInt(data.credit_score),
                total_asset: Math.log(parseFloat(data.total_asset) + 1)
            };
            
            // Call your real model via proxy
            const PROXY_URL = 'https://o2jkugl6ed.execute-api.eu-central-1.amazonaws.com/prod/predict';
            
            let prediction;
            try {
                const response = await fetch(PROXY_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.dumps(modelInput)
                });
                
                const result = await response.json();
                prediction = result.prediction;
                console.log('Real model prediction:', prediction);
            } catch (error) {
                console.error('Error calling model:', error);
                // Fallback to demo logic if API fails
                const income = parseInt(data.income);
                const creditScore = parseInt(data.credit_score);
                prediction = (income > 4000000 && creditScore > 700) ? 1 : 0;
                console.log('Fallback prediction:', prediction);
            }
            
            const result = document.getElementById('result');
            
            if (prediction === 1) {
                result.className = 'result approved';
                result.innerHTML = `
                    <h2>‚úÖ APPROVED</h2>
                    <p>Congratulations! Your loan has been approved.</p>
                    <small>Prediction: ${prediction}</small>
                `;
            } else {
                result.className = 'result rejected';
                result.innerHTML = `
                    <h2>‚ùå REJECTED</h2>
                    <p>Sorry, your loan application has been rejected.</p>
                    <small>Prediction: ${prediction}</small>
                `;
            }
            
            result.style.display = 'block';
        });
    </script>
</body>
</html>